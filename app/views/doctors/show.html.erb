<div class="container mt-navbar">
  <div class="flex">
    <div class="col-6 rounded-circle" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.45)), url('https://source.unsplash.com/400x300/?cocktail');">
    </div>
    <div class="col-6">
      <h1><%= @doctor.user.first_name.capitalize %></h1>
      <h3>
        <% specialties = [] %>
        <% @doctor.specialties.each do |specialty| %>
          <% specialties << specialty.name %>
        <% end %>
        <%= specialties.join(', ') %>
      </h3>
      <p>Professional register: <%= @doctor.professional_register.upcase %></p>
      <p>Address: <%= @doctor.address.capitalize %></p>
    </div>
  </div>
  <% if current_user == @doctor.user %>
    <div class="flex mr-3">
      <%= link_to( @doctor, method: :delete, data: { confirm: 'Are you sure?' }) do %>
        <i class="far fa-trash-alt mr-2"></i> Delete my doctor account
      <% end %>
      |
      <%= link_to "Edit my info", edit_doctor_path(@doctor) %>
    </div>
  <% end %>


  <% if current_user != @doctor.user %>
  <div class="row justify-content-around mr-1">
    <% @doctor.offers.each do |offer| %>
      <% if offer.available == true %>
        <div class="card-flex flex-grow-1 col-4">
          <h5 class="font-black font-bold">
            <%= offer.start_date.to_s.gsub(/ .*\z/,"") %>
            <%= offer.start_date.strftime('%A') %>
            <%= offer.start_date.to_s.gsub(/\d{4}-\d\d-\d\d /,"").gsub(/:\d\d -0300/,"")  %>
             -
            <%= offer.end_date.to_s.gsub(/\d{4}-\d\d-\d\d /,"").gsub(/:\d\d -0300/,"")  %>
                  </h5>

                  <%= link_to offer_consultations_path(offer), method: "post" do %>
                    <button class="blearn-more mt-3">
                        <div class="bcircle">
                          <span class="bicon barrow"></span>
                        </div>
                        <p class="bbutton-text">BOOK</p>
                      </button>
                    <% end %>
                  <%#= link_to  "BOOK", offer_consultations_path(offer), class: "btn card-flex-btn mt-2", method: "post" %>
                <p></p>
              </div>
      <% end %>
    <% end %>
  </div>
  <% end %>

      <%= link_to "Back", root_path %>

    <h3>Reviews</h3>
    <% if @doctor.reviews.empty? %>
      <p>Be the first to let a review</p>
    <% else %>
      <ul class="list-group">
        <% @doctor.reviews.each do |review| %>
          <li class="list-group-item d-flex justify-content-start align-items-center">
            <span class="badge badge-primary badge-pill mr-3">
              <% counter = 0 %>
              <% 5.times do %>
                <i class="fa <%= review.rating > counter ? 'fa-star' : 'fa-star-o' %>"></i>
                <% counter += 1 %>
              <% end %>
            </span>
            <%= review.content %>
          </li>
        <% end %>
      </ul>
    <% end %>

    <% unless @doctor.user == current_user %>
      <%= render "reviews/new", doctor: @doctor, review: @review %>
    <% end %>
</div>
